---
title: "Flexdashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(tidyverse)
library(p8105.datasets)
library(plotly)
```

# Importing Data 
```{r}
data("instacart")
instacart_small = instacart |>
sample_n(5000) |>
mutate(
dow = factor(order_dow, labels = c("Sun","Mon","Tue","Wed","Thu","Fri","Sat"))
)
```

Column {data-width=650}
-----------------------------------------------------------------------

### Chart A: Line graph with slider 
```{r}
orders_by_hour_dow = instacart_small |>
  count(dow, order_hour_of_day)

orders_by_hour_dow |>
  plot_ly(x = ~order_hour_of_day, y = ~n,
    color = ~dow,
    type  = "scatter",
    mode  = "lines+markers",
    colors = "viridis") |>
  layout(
    title = "Orders by Hour of Day (colored by Day of Week)",
    xaxis = list(title = "Hour of day", rangeslider = list(visible = TRUE)),
    yaxis = list(title = "Number of orders")
)
```

This line plot shows the number of Instacart orders placed at each hour of the day, separated by day of the week. Peaks occur in the late morning to early evening, indicating that most users shop during daytime hours. Sunday shows the highest order volume throughout the day, while weekday activity is more moderate and consistent. 

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B: Bar graph showing top products 

```{r}
top_products = instacart_small |>
count(product_name, sort = TRUE) |>
slice_max(n, n = 10) |>
mutate(product_name = fct_reorder(product_name, n))

top_products |>
plot_ly(x = ~product_name,y = ~n,
color = ~product_name,
type = "bar",
colors = "viridis"
)
```

This bar chart displays the ten most frequently purchased products. Items such as bananas, avocados, and organic milk dominate customer orders. 

### Chart C: Box plot showing the add to cart order by day of the week 

```{r}
instacart_small |>
  plot_ly( x = ~dow, y = ~add_to_cart_order,
    color = ~dow,
    type = "box",
    colors = "viridis"
  ) |>
  layout(
    title = "Add to Cart Order by Day of Week",
    xaxis = list(title = "Day of Week"),
    yaxis = list(title = "Position in Cart")
  )
```

This boxplot illustrates when items are added to customers’ carts across days of the week. Median positions remain relatively consistent, suggesting stable shopping behavior, but weekends show slightly greater variability—indicating larger or more variable carts on those days.

